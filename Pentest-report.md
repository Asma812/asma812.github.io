Penetration Testing Report
==========================

Target: _2Million_ (Hack The Box)
---------------------------------

**Author:** Asma Neji**Date:** February 2026**Assessment Type:** Black‑Box / Capture The Flag (CTF‑style)**Objective:** Identify vulnerabilities, gain privileged access, and retrieve flags

1\. Executive Summary
---------------------

The target system _2Million_ was assessed to identify security weaknesses that could allow unauthorized access or privilege escalation.

During the assessment, multiple vulnerabilities were identified, including **insecure application logic**, **information disclosure**, and a **critical Linux kernel vulnerability (CVE‑2023‑0386)** that allowed **local privilege escalation to root**.

Successful exploitation resulted in full system compromise and access to sensitive files, including the root flag.

2\. Scope & Methodology
-----------------------

### Scope

*   Target IP: 10.129.xxx.xxx
    
*   Services assessed:
    
    *   Web application
        
    *   Linux operating system
        
    *   Local privilege boundaries
        

### Methodology

The assessment followed a standard penetration testing approach:

1.  **Reconnaissance**
    
    *   Service enumeration
        
    *   Web application analysis
        
2.  **Initial Access**
    
    *   Application logic abuse
        
    *   Credential and information discovery
        
3.  **Privilege Escalation**
    
    *   Local enumeration
        
    *   Kernel vulnerability analysis
        
4.  **Post‑Exploitation**
    
    *   Root access verification
        
    *   Flag retrieval
        

3\. Findings & Exploitation Summary
-----------------------------------

### 3.1 Web Application Weaknesses

**Finding:** Insecure application logic and exposed functionality

*   The web application allowed unintended actions without proper authorization checks.
    
*   Sensitive endpoints and administrative functionality were discoverable.
    

**Impact:**This allowed an attacker to gain an authenticated shell as a low‑privileged user on the system.

**Risk Level:** Medium

### 3.2 Information Disclosure

**Finding:** Sensitive internal information exposed

*   Emails, internal identifiers, and system hints were accessible.
    
*   One exposed email address (ch4p@2million.htb) provided valuable context for further enumeration.
    

**Impact:**Information disclosure significantly reduced the attack complexity and guided later exploitation.

**Risk Level:** Medium

### 3.3 Local Privilege Escalation (Critical)

**Finding:** Vulnerable Linux kernel – OverlayFS

*   The system was running a Linux kernel vulnerable to **CVE‑2023‑0386**.
    
*   This vulnerability allows attackers to **move files within the Overlay filesystem while preserving metadata**, including:
    
    *   File ownership
        
    *   SetUID bit
        

**CVE Details**

*   **CVE ID:** CVE‑2023‑0386
    
*   **Type:** Local Privilege Escalation
    
*   **Affected Component:** OverlayFS
    
*   **Severity:** Critical
    

**Impact:**A local attacker can escalate privileges from a standard user to **root**, resulting in **full system compromise**.

**Risk Level:**  Critical

4\. Post‑Exploitation
---------------------

After successful privilege escalation:

*   Root access was obtained
    
*   System integrity was fully compromised
    
*   Sensitive files were accessible
    
*   The root flag was retrieved from /root/
    

This confirms a **complete compromise of the target system**.

5\. Impact Assessment
---------------------

If exploited in a real‑world environment, this vulnerability chain could lead to:

*   Full server takeover
    
*   Unauthorized access to sensitive data
    
*   Persistence installation
    
*   Lateral movement within internal networks
    
*   Total loss of confidentiality, integrity, and availability
    

6\. Recommendations & Mitigations
---------------------------------

### Immediate Actions

*    **Update the Linux kernel** to a version patched against CVE‑2023‑0386
    
*    Restrict OverlayFS usage where not required
    

### Web Application Hardening

*   Implement strict authorization checks
    
*   Remove exposed administrative functionality
    
*   Sanitize and restrict sensitive endpoints
    

### Monitoring & Defense

*   Enable:
    
    *   File integrity monitoring
        
    *   Privilege escalation detection
        
    *   Kernel exploit detection (EDR/XDR)
        
*   Regular vulnerability scanning and patch management
    

7\. Conclusion
--------------

The _2Million_ machine demonstrates how **chained vulnerabilities** — from weak application logic to unpatched kernel flaws — can result in **full system compromise**.

This assessment highlights the importance of:

*   Secure application design
    
*   Least privilege principles
    
*   Timely system patching
    
*   Continuous security monitoring
    

8\. Skills Demonstrated
-----------------------------------------

*   Web application security testing
    
*   Linux privilege escalation
    
*   CVE research and exploitation analysis
    
*   System enumeration
    
*   Post‑exploitation validation
    
*   Professional reporting

Practical Exploitation Walkthrough & Reasoning
==============================================

This section describes the **step‑by‑step practical process**, explaining **how each question was answered**, the **thought process behind every decision**, and how the attack chain was built from initial access to root compromise.

1\. Initial Reconnaissance & Web Enumeration
--------------------------------------------

### Observation

The target exposed a web application related to **HTB VPN / account management**.

### Thought Process

Whenever a web application is present, the first objective is:

*   Understand its **functionality**
    
*   Identify **hidden endpoints**
    
*   Look for **logic flaws**, not only technical bugs
    

CTF-style machines often hide critical information behind:

*   Unlinked pages
    
*   API endpoints
    
*   JavaScript files
    

### Action

*   Explored the website manually
    
*   Inspected page source
    
*   Enumerated JavaScript files
    

### Result

JavaScript files revealed **API routes** and internal application logic, confirming that:

*   The application communicates with backend endpoints
    
*   Some endpoints were accessible without strict authorization
    

This gave us confidence that **logic abuse** would be key.

2\. Gaining Initial Access (User Shell)
---------------------------------------

### Observation

The application allowed interaction with backend functionality that should normally be restricted.

### Thought Process

At this stage, the goal was **not root**, but:

> “How do I become _any_ system user?”

Because:

*   Local privilege escalation **always requires local access**
    
*   Kernel exploits cannot be used remotely
    

### Action

By abusing exposed functionality, we obtained:

*   Valid application interaction
    
*   A foothold that resulted in a **low‑privileged shell** on the system
    

### Result

We gained access as a non‑privileged user (www-data / admin context).

This confirmed:

*   The application layer was compromised
    
*   The attack surface moved from _web_ → _local system_
    

3\. Question:
-------------

### _“What is the email address of the sender of the email sent to admin?”_

### Observation

Once inside the system, application files and data were accessible.

### Thought Process

This question suggests:

*   Emails are **stored locally**
    
*   Or referenced in application files or database content
    

CTF logic:

> If a question mentions _email sender_, it’s usually **hardcoded**, **logged**, or **stored in config/data files**.

### Action

*   Enumerated application directories
    
*   Looked for references to emails in:
    
    *   Source code
        
    *   Configuration files
        
    *   Database‑related content
        

### Result

We identified the sender email:

   ch4p@2million.htb  

This validated:

*   Sensitive internal data exposure
    
*   Weak separation between application logic and secrets
    

4\. Local Enumeration (Preparing for Privilege Escalation)
----------------------------------------------------------

### Observation

We now had a local shell but **no root access**.

### Thought Process

At this point, the mindset shifts to:

> “What can this system give me that it shouldn’t?”

Key checks:

*   Kernel version
    
*   Installed packages
    
*   Sudo permissions
    
*   Misconfigurations
    

Kernel exploits are **very common on HTB** when:

*   The machine is Linux
    
*   No sudo rights are granted
    

### Action

*   Enumerated system information
    
*   Checked kernel version
    
*   Compared it against known vulnerabilities
    

### Result

The kernel version matched a **known vulnerable range**.

This led directly to researching **recent Linux privilege escalation CVEs**.

5\. Question:
-------------

### _“What is the 2023 CVE ID for a vulnerability that allows an attacker to move files in the Overlay filesystem while maintaining metadata like owner and SetUID bits?”_

### Thought Process

This question gives **very specific hints**:

*   Overlay filesystem
    
*   Preserved metadata
    
*   SetUID bits
    
*   2023 CVE
    

This is **not guesswork** — it’s targeted research.

### Action

*   Searched for:
    
    *   “OverlayFS privilege escalation 2023”
        
    *   “OverlayFS SetUID CVE”
        
*   Cross‑checked results with kernel version
    

### Result

The vulnerability clearly matched:

 CVE-2023-0386   

This confirmed:

*   The machine was intentionally vulnerable
    
*   Privilege escalation was feasible
    

6\. Exploit Preparation & Transfer
----------------------------------

### Observation

An exploit was publicly available on GitHub.

### Thought Process

Since:

*   The target had no internet restrictions
    
*   We had a local shell
    
*   File permissions were limited in /var/www/html
    

We needed:

*   A writable directory
    
*   A safe way to transfer files
    

### Action

*   Hosted the exploit on the attacker machine using a local HTTP server
    
*   Downloaded it on the target in a writable directory (e.g. /tmp or user home)
    

This step also reinforced an important lesson:

> **Permission errors are not failures, they guide you to the right location**

7\. Privilege Escalation to Root
--------------------------------

### Observation

CVE‑2023‑0386 allows:

*   Manipulation of OverlayFS
    
*   Preservation of SetUID bit
    
*   Execution of files as root
    

### Thought Process

This is a **local privilege escalation**, meaning:

*   No need for credentials
    
*   No brute force
    
*   Just correct exploit execution
    

### Action

*   Executed the exploit as the low‑privileged user
    
*   Leveraged OverlayFS behavior to escalate privileges
    

### Result

We successfully obtained a **root shell**.

At this point:

*   The system was fully compromised
    
*   All privilege boundaries were bypassed
    

8\. Final Question:
-------------------

### _“Submit the flag located in root’s home directory.”_

### Thought Process

Classic HTB confirmation step:

> Root access must be proven.

### Action

*   Navigated to /root/
    
*   Read the flag file
    

### Result

Root flag successfully retrieved, confirming **complete compromise**.

9\. Attack Chain Summary
------------------------------------

1.  Web application enumeration
    
2.  Logic abuse → initial user shell
    
3.  Local enumeration
    
4.  Kernel version analysis
    
5.  CVE identification (CVE‑2023‑0386)
    
6.  Exploit transfer
    
7.  Privilege escalation to root
    
8.  Flag retrieval
